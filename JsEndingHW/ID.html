<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ID</title>
</head>
<body>
    <script>

        FirstEN = "ABCDEFGHJKLMNPQRSTUVXYWZIO";
        document.write(FirstEN.length+ "<br>");
        // document.write(FirstEN[0] + "<br>");

        detect = (identity) => {

            //-----------------------------------------------------------------10 char limit

            if (identity.length > 10){
                document.write("超過10個字元" + "<br>");
                return document.write("請重新輸入");
            }
            else if (identity.length < 10){
                document.write("小於10個字元" + "<br>");
                return document.write("請重新輸入")
            }
            else document.write("correct length" + "<br>");

            //----------------------------------------------------------------First EN or not?

            for (let i = 0; i < 26; i++){
                // document.write(identity.charAt(0).toUpperCase() + "<br>");
                if (FirstEN.indexOf(identity.charAt(0).toUpperCase()) == -1){
                    return document.write("第一個字元必須是英文");
                }
            }

            //----------------------------------------------------------------second must 1 or 2

            if (identity.charAt(1) != 1 && identity.charAt(1) != 2){
                return document.write("第二個字元必須是1或2");
            }

            //----------------------------------------------------------------third to tenth is Num or not?

            for (let i = 2; i < identity.length; i++){
                if (isNaN(identity[i]) == true){
                    return document.write("第三個字元到第十個字元必須為數字");
                }
            }

            //----------------------------------------------------------------check last code

            var sum = 0;
            var flag = 8;
            for (let i = 1; i < 9; i++){
                sum += identity[i]*flag;
                flag -= 1;
            }

            // document.write(sum + "<br>");

            var OneNineNum = FirstEN.indexOf(identity[0].toUpperCase());

            // document.write(OneNineNum + "<br>");

            OneNineNum += 10;

            // document.write(OneNineNum + "<br>");

            var ONString = OneNineNum.toString();

            // document.write(ONString + "<br>");

            var ONarr = ONString.split("");

            // console.log(ONarr);
            // console.log(ONarr[0]);
            // console.log(ONarr[1]);

            sum += ONarr[0]*1;
            sum += ONarr[1]*9;

            document.write("Final sum = " + sum + "<br>");

            var antiN = sum % 10;
            if (antiN == 0) antiN = 10;

            if (identity[9] == 10-antiN) return document.write("身分證驗證成功");
            else return document.write("身分證驗證失敗");
        }

        detect("")
        



    </script>
</body>
</html>